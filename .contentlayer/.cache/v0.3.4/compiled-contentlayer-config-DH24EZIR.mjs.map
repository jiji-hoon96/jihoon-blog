{
  "version": 3,
  "sources": ["../../../contentlayer.config.ts", "../../../src/lib/rehype-image-path.ts"],
  "sourcesContent": ["import { defineDocumentType, makeSource } from 'contentlayer/source-files'\nimport rehypeAutolinkHeadings from 'rehype-autolink-headings'\nimport rehypePrettyCode from 'rehype-pretty-code'\nimport rehypeSlug from 'rehype-slug'\nimport remarkGfm from 'remark-gfm'\nimport readingTime from 'reading-time'\nimport { rehypeImagePath } from './src/lib/rehype-image-path'\n\nexport const Post = defineDocumentType(() => ({\n  name: 'Post',\n  filePathPattern: `**/*.md`,\n  contentType: 'markdown',\n  fields: {\n    title: { type: 'string', required: true },\n    date: { type: 'date', required: true },\n    emoji: { type: 'string', required: true },\n    categories: { type: 'string', required: true },\n    draft: { type: 'boolean', required: false },\n  },\n  computedFields: {\n    slug: {\n      type: 'string',\n      resolve: (doc) => {\n        // Extract YYMMDD from path: content/240101/index.md -> /240101\n        const pathParts = doc._raw.flattenedPath.split('/')\n        return `/${pathParts[pathParts.length - 1]}`\n      },\n    },\n    categoryArray: {\n      type: 'list',\n      resolve: (doc) => doc.categories.split(' ').filter(c => !c.includes('ignore')),\n    },\n    readingTime: {\n      type: 'string',\n      resolve: (doc) => readingTime(doc.body.raw).text,\n    },\n    excerpt: {\n      type: 'string',\n      resolve: (doc) => {\n        // Generate excerpt from body (first 200 chars)\n        const text = doc.body.raw.replace(/```[\\s\\S]*?```/g, '').replace(/#/g, '').trim()\n        return text.slice(0, 200) + (text.length > 200 ? '...' : '')\n      },\n    },\n  },\n}))\n\nexport default makeSource({\n  contentDirPath: './content',\n  documentTypes: [Post],\n  disableImportAliasWarning: true,\n  markdown: {\n    remarkPlugins: [],\n    rehypePlugins: [\n      rehypeSlug,\n      [\n        rehypeAutolinkHeadings,\n        {\n          behavior: 'wrap',\n          properties: {\n            className: ['anchor'],\n          },\n        },\n      ],\n      [\n        rehypePrettyCode as any,\n        {\n          theme: {\n            dark: 'github-dark',\n            light: 'github-light',\n          },\n          keepBackground: false,\n        },\n      ],\n      rehypeImagePath as any,\n    ],\n  },\n})\n", "import { visit } from 'unist-util-visit'\nimport { Root } from 'hast'\nimport path from 'path'\n\n/**\n * Rehype plugin to convert relative image paths to absolute paths\n * Converts: ![alt](image.jpg) -> ![alt](/content/240909/image.jpg)\n */\nexport function rehypeImagePath() {\n  return (tree: Root, file: any) => {\n    // Extract folder name from multiple possible sources\n    let folderName = ''\n    \n    // Try file.history first\n    if (file.history && file.history.length > 0) {\n      const filePath = file.history[0]\n      const match = filePath.match(/content\\/([^\\/]+)\\//)\n      if (match) {\n        folderName = match[1]\n      }\n    }\n    \n    // Fallback to file.path\n    if (!folderName && file.path) {\n      const match = file.path.match(/content\\/([^\\/]+)\\//)\n      if (match) {\n        folderName = match[1]\n      }\n    }\n    \n    // Fallback to file.dirname (used by contentlayer)\n    if (!folderName && file.dirname) {\n      folderName = path.basename(file.dirname)\n    }\n\n    // Fallback to _raw.sourceFileDir (contentlayer specific)\n    if (!folderName && file.data?.rawDocumentData?.sourceFileDir) {\n      folderName = file.data.rawDocumentData.sourceFileDir\n    }\n\n    if (!folderName) {\n      console.warn('[rehype-image-path] Could not determine folder name for:', file.path || file.history?.[0] || 'unknown')\n      return\n    }\n\n    visit(tree, 'element', (node: any) => {\n      // Process img tags\n      if (node.tagName === 'img' && node.properties?.src) {\n        const src = node.properties.src as string\n\n        // Only process relative paths (not starting with http, https, or /)\n        if (!src.startsWith('http') && !src.startsWith('https') && !src.startsWith('/')) {\n          const newSrc = `/content/${folderName}/${src}`\n          console.log(`[rehype-image-path] Converting: ${src} -> ${newSrc}`)\n          node.properties.src = newSrc\n        }\n      }\n    })\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
